# RC4

## 整体梳理
### 初始化
S 盒是加密的关键，首先 S 盒会被初始化成一个长度 256 存放 0-255 的数组。然后把 key 信息揉进 S 盒中。
```c++
// 根据密钥初始化 T 表
for (int i = 0; i < 256; ++i)
{
    T[i] = key[i % keyLength];
}

// 打乱 S 盒
for (int i = 0, j = 0; i < 256; ++i)
{
    j = (j + S[i] + T[i]) % 256;
    swap(S[i], S[j]);
}
```
### 加密/解密
将 S 盒与待加密数据异或一遍，然后交换 S 盒，不断重复。
```c++
for (unsigned int h = 0; h < dataLength; ++h)
{
    i = (i + 1) % 256;
    j = (j + S[i]) % 256;
    swap(S[i], S[j]);
    
    t = (S[i] + S[j]) % 256;
    k = S[t];
    data[h] ^= k;
}
```

## 特点梳理
### 特点一
256：在初始化阶段，将 key 信息揉进 S 盒过程中，会构建一个 T 表，里面是将 key 的信息不断重复，然后 T 表用来打乱 S 盒，即算出下标不断置换 S 盒的内容，而 S 盒与 T 表都是长度为 256 的数组。

### 特点二
交换：S 盒被不断的更新，表现为数组两个值不断交换位置。初始化交换 256 次、加密/解密每异或一个字节交换一次。